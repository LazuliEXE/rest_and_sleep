<!DOCTYPE html>
<html lang="fr">
    <head>
    <meta charset="UTF-8">
    <title>Gestion des utilisateurs</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
    </head>
    <body class="bg-light">

    <nav class="navbar navbar-expand-lg navbar-dark bg-primary shadow">
        <div class="container-fluid">
        <a class="navbar-brand" href="dashboard.html">Rest And Sleep</a>
        <button class="btn btn-outline-light" id="logoutBtn">Déconnexion</button>
        </div>
    </nav>

    <div class="container mt-5">
        <div class="d-flex justify-content-between align-items-center mb-4">
        <h1 class="text-primary">Utilisateurs</h1>
        <button class="btn btn-success" id="addUserBtn">Ajouter un utilisateur</button>
        </div>

        <div id="usersList" class="row g-4">
        <!-- Utilisateurs affichés ici -->
        </div>
    </div>

    <!-- Bootstrap JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>

    <script>
        // Protéger la page
        const token = localStorage.getItem('token');
        if (!token) {
        alert("Vous devez être connecté.");
        window.location.href = './connexion.html';
        }

        document.getElementById('logoutBtn').addEventListener('click', () => {
        localStorage.removeItem('token');
        window.location.href = 'connexion.html';
        });

        // Charger les utilisateurs
        fetch('http://localhost:3000/users', {
        headers: {
            Authorization: 'Bearer ' + token
        }
        })
        .then(res => res.json())
        .then(data => {
        const container = document.getElementById('usersList');
        if (data.length === 0) {
            container.innerHTML = '<p class="text-muted">Aucun utilisateur trouvé.</p>';
            return;
        }

        data.forEach(user => {
            const col = document.createElement('div');
            col.className = 'col-md-4';
            col.innerHTML = `
            <div class="card shadow-sm border-0 h-100">
                <div class="card-body">
                <h5 class="card-title">${user.nom}</h5>
                <p class="card-text"><strong>Email :</strong> ${user.email}</p>
                <p class="card-text"><strong>Rôle ID :</strong> ${user.role_id}</p>
                </div>
            </div>
            `;
            container.appendChild(col);
        });
        })
        .catch(err => {
        console.error(err);
        alert("Erreur lors du chargement des utilisateurs.");
        });

        // Ajout futur
        document.getElementById('addUserBtn').addEventListener('click', () => {
        alert("Fonction d'ajout en cours de développement !");
        // Ici on ouvrira un formulaire modal ou redirigera vers une autre page
        });
    </script>
    </body>
</html>
